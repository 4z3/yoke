<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Yoke a middleware framework for Vert.x: Rest</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; }
code > span.dt { color: #204a87; }
code > span.dv { color: #0000cf; }
code > span.bn { color: #0000cf; }
code > span.fl { color: #0000cf; }
code > span.ch { color: #4e9a06; }
code > span.st { color: #4e9a06; }
code > span.co { color: #8f5902; font-style: italic; }
code > span.ot { color: #8f5902; }
code > span.al { color: #ef2929; }
code > span.fu { color: #000000; }
code > span.er { font-weight: bold; }
  </style>
  <link rel="stylesheet" href="style.css" type="text/css" />
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#yoke"><a href="/">Yoke</a></a><ul>
<li><a href="#jsonrestrouter">JsonRestRouter</a></li>
<li><a href="#create-a-rest-resource">Create a REST resource</a></li>
</ul></li>
</ul>
</div>
<h1 id="yoke"><a href="#yoke"><a href="/">Yoke</a></a></h1>
<h2 id="jsonrestrouter"><a href="#jsonrestrouter">JsonRestRouter</a></h2>
<p>JsonRestRouter is a extra middleware module built specifically to enable you to build correct REST web services. It intentionally extends Yoke <a href="Router.html">Router</a> middleware as that is more or less the de facto API for writing web applications on top of Yoke.</p>
<p>In short, JsonRestRouter adds a data store backend to a router and implements all basic content negotiation (just JSON) and all the REST semantics.</p>
<p>There are 6 verbs:</p>
<ul>
<li><em>QUERY</em> - maps to HTTP GET /resource</li>
<li><em>READ</em> - maps to HTTP GET /resource/:id</li>
<li><em>UPDATE</em> - maps to HTTP PUT /resource/:id</li>
<li><em>APPEND</em> - maps to HTTP PATCH /resource/:id</li>
<li><em>CREATE</em> - maps to HTTP POST /resource</li>
<li><em>DELETE</em> - maps to HTTP DELETE /resource/:id</li>
</ul>
<p>In order to use JsonRestRouter you need to have a Store implementation (yoke extras) bundles a MongoDb store.</p>
<h2 id="create-a-rest-resource"><a href="#create-a-rest-resource">Create a REST resource</a></h2>
<pre class="sourceCode java"><code class="sourceCode java"><span class="dt">final</span> Yoke yoke = <span class="kw">new</span> <span class="fu">Yoke</span>(vertx);

JsonObject persistorCfg = <span class="kw">new</span> <span class="fu">JsonObject</span>();
persistorCfg.<span class="fu">putString</span>(<span class="st">&quot;host&quot;</span>, <span class="st">&quot;localhost&quot;</span>);
persistorCfg.<span class="fu">putNumber</span>(<span class="st">&quot;port&quot;</span>, <span class="dv">27017</span>);
persistorCfg.<span class="fu">putString</span>(<span class="st">&quot;address&quot;</span>, <span class="st">&quot;mongo.persons&quot;</span>);
persistorCfg.<span class="fu">putString</span>(<span class="st">&quot;db_name&quot;</span>, <span class="st">&quot;yoke-extras&quot;</span>);

<span class="dt">final</span> EventBus eb = vertx.<span class="fu">eventBus</span>();

<span class="co">// deploy mongo module</span>
container.<span class="fu">deployModule</span>(<span class="st">&quot;io.vertx~mod-mongo-persistor~2.0.0-beta1&quot;</span>, persistorCfg);

<span class="co">// db access</span>
<span class="dt">final</span> MongoDbStore db = <span class="kw">new</span> <span class="fu">MongoDbStore</span>(eb, <span class="st">&quot;mongo.persons&quot;</span>);

JsonRestRouter router = <span class="kw">new</span> <span class="fu">JsonRestRouter</span>(db);
router.<span class="fu">rest</span>(<span class="st">&quot;/persons&quot;</span>, <span class="st">&quot;persons&quot;</span>);
yoke.<span class="fu">use</span>(router);
yoke.<span class="fu">listen</span>(<span class="dv">8080</span>);

container.<span class="fu">logger</span>().<span class="fu">info</span>(<span class="st">&quot;Yoke server listening on port 8080&quot;</span>);</code></pre>
<p>All you need to define is a Database store and after create a router with at least 2 arguments:</p>
<ul>
<li>resource - the root resource for the REST call (e.g.: <em>/persons</em>)</li>
<li>entityName - the entity name, in mongoDb terms this is the collection name (e.g.: <em>persons</em>)</li>
<li>allowedVerbs - a sum of all verbs as described before, or in case of not specified all are included</li>
</ul>
<div id="footer">
  &copy; 2013 <a href="http://www.jetdrone.com">Paulo Lopes</a>
</div>
<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://pmlopes.github.io/yoke/">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<!-- Place this tag where you want the +1 button to render. -->
<div class="g-plusone" data-size="medium" data-href="http://pmlopes.github.io/yoke/"></div>

<!-- Place this tag after the last +1 button tag. -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3682522-6', 'github.io');
  ga('send', 'pageview');

</script>
</body>
</html>
